<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="{{ refresh_interval }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weathermonitor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.1/css/bulma.min.css" />
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 1em 0 0;
            overflow: hidden;
        }
        .container {
            height: 100%;
            max-width: 100% !important;
        }
        .box {
            height: 100%;
            margin: 2em;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
</head>

<body>
<div class="container">
    <header>
        <nav class="navbar is-dark is-fixed-top">
            <div class="navbar-end">
              <span class="navbar-item">
                <span class="tag is-info is-medium" id="status">
                  <span class="icon is-small">
                    <i class="fas fa-circle"></i>
                  </span>
                  <span>Live</span>
                </span>
              </span>
            </div>
        </nav>
    </header>
    <div class="box">
        {% include subpage+'.html' %}
    </div>
</div>

<script>
    if (navigator.onLine && '{{status[0]}}' === 'True') {
        // Set the text and color of the status bar
        document.getElementById('status').innerHTML = 'Live';
        document.getElementById('status').classList.remove('is-danger');
        document.getElementById('status').classList.add('is-info');
    } else {
        document.getElementById('status').innerHTML = 'Offline';
        document.getElementById('status').classList.remove('is-info');
        document.getElementById('status').classList.add('is-danger');
    }
</script>
<script>

    $(document).ready(function() {
        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);
        const objects = document.querySelectorAll("object");
        objects.forEach((object) => {
            object.addEventListener("load", (evt) => {
                const doc = evt.target.contentDocument;
                // add your event here
                doc.addEventListener("touchstart", handleTouchStart, false);
                doc.addEventListener("touchmove", handleTouchMove, false);
            });
        });

        // do the same querz above but for every object
    });
    var xDown = null;
    var yDown = null;

    function handleTouchStart(evt) {
        xDown = evt.touches[0].clientX;
        yDown = evt.touches[0].clientY;
    };

    function handleTouchMove(evt) {
        if ( ! xDown || ! yDown ) {
            return;
        }

        var xUp = evt.touches[0].clientX;
        var yUp = evt.touches[0].clientY;

        var xDiff = xDown - xUp;
        var yDiff = yDown - yUp;

        if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {/*most significant*/
            if ( xDiff > 0 ) {
                /* left swipe */
                sendSwipeEvent('left', evt.target);
            } else {
                /* right swipe */
                sendSwipeEvent('right', evt.target);
            }
        } else {
            if ( yDiff > 0 ) {
                /* up swipe */
                sendSwipeEvent('up', evt.target);
            } else {
                /* down swipe */
                sendSwipeEvent('down', evt.target);
            }
        }
        /* reset values */
        xDown = null;
        yDown = null;
    };


    function sendSwipeEvent(direction, target) {
        console.log('swipe ' + direction);

        // trigger the 'swipe' event
        document.dispatchEvent(new CustomEvent('swipe', {detail: {direction: direction, target: target}}));
    }




</script>
</body>